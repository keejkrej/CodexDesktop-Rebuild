import{m as q,s as N,bg as U,bh as W,j as n,c as _,M as c,E as A,bi as $,bj as V,B as C,C as E,A as B,k as L,l as z,S as P,h as Q,bk as H,H as K,bl as G,bm as X,bn as Y,y as R,u as J,z as Z,bo as D,o as ee,i as te,Q as oe}from"./index-C4i7VkvA.js";const ne=["untrusted","on-failure","on-request","never"],se=["read-only","workspace-write","danger-full-access"];function ie(){const t=q(),e=N(),{data:s,isPending:o}=U(),{data:i,isPending:l}=W(),a=s?.config??null,d=s?.configWriteTarget??null,g=o||l,b=i?.requirements?.allowedApprovalPolicies,y=i?.requirements?.allowedSandboxModes,u=O(b,ne),p=O(y,se),m=F(a?.approval_policy??null,u),S=F(a?.sandbox_mode??null,p);async function f(r,x){try{await t.writeConfigValue({keyPath:r,value:x,mergeStrategy:"upsert",filePath:d?.filePath??null,expectedVersion:d?.expectedVersion??null})}catch(h){$.error(`Failed to update config ${r}: ${String(h)}`)}finally{await e.invalidateQueries({queryKey:V}),await e.invalidateQueries({queryKey:["user-saved-config"]})}}return n.jsxs(n.Fragment,{children:[n.jsx(I,{options:u,selected:m,isLoading:g,labelMessage:{id:"settings.agent.configuration.approvalPolicy.label",defaultMessage:"Approval policy",description:"Label for config.toml approval policy"},descriptionMessage:{id:"settings.agent.configuration.approvalPolicy.description",defaultMessage:"When Codex asks for approval to run actions",description:"Description for config.toml approval policy"},renderLabel:r=>n.jsx(le,{policy:r}),onUpdate:r=>f("approval_policy",r)}),n.jsx(I,{options:p,selected:S,isLoading:g,labelMessage:{id:"settings.agent.configuration.sandboxMode.label",defaultMessage:"Sandbox mode",description:"Label for config.toml sandbox mode"},descriptionMessage:{id:"settings.agent.configuration.sandboxMode.description",defaultMessage:"Filesystem access for agent actions",description:"Description for config.toml sandbox mode"},renderLabel:r=>n.jsx(ae,{mode:r}),onUpdate:r=>f("sandbox_mode",r)})]})}function O(t,e){if(t==null||t.length===0)return e;const s=t.filter(o=>e.includes(o));return s.length>0?s:e}function F(t,e){return t==null?null:e.includes(t)?t:null}function I(t){const e=_.c(35),{options:s,selected:o,isLoading:i,labelMessage:l,descriptionMessage:a,renderLabel:d,onUpdate:g}=t;let b;e[0]!==d||e[1]!==o?(b=o==null?n.jsx(k,{}):d(o),e[0]=d,e[1]=o,e[2]=b):b=e[2];const y=b;let u;e[3]!==l?(u=n.jsx(c,{...l}),e[3]=l,e[4]=u):u=e[4];let p;e[5]!==a?(p=n.jsx(c,{...a}),e[5]=a,e[6]=p):p=e[6];let m;e[7]!==i||e[8]!==y?(m=n.jsx(C,{className:"min-w-[200px] justify-between",color:"secondary",size:"toolbar",disabled:i,children:y}),e[7]=i,e[8]=y,e[9]=m):m=e[9];const S=o==null?A:void 0;let f;e[10]!==g||e[11]!==o?(f=()=>{o!=null&&g(null)},e[10]=g,e[11]=o,e[12]=f):f=e[12];let r;e[13]===Symbol.for("react.memo_cache_sentinel")?(r=n.jsx(k,{}),e[13]=r):r=e[13];let x;e[14]!==S||e[15]!==f?(x=n.jsx(E.Item,{RightIcon:S,onSelect:f,children:r}),e[14]=S,e[15]=f,e[16]=x):x=e[16];let h;if(e[17]!==g||e[18]!==s||e[19]!==d||e[20]!==o){let v;e[22]!==g||e[23]!==d||e[24]!==o?(v=w=>{const T=w===o;return n.jsx(E.Item,{RightIcon:T?A:void 0,onSelect:()=>{T||g(w)},children:d(w)},w)},e[22]=g,e[23]=d,e[24]=o,e[25]=v):v=e[25],h=s.map(v),e[17]=g,e[18]=s,e[19]=d,e[20]=o,e[21]=h}else h=e[21];let j;e[26]!==i||e[27]!==m||e[28]!==x||e[29]!==h?(j=n.jsxs(B,{align:"end",disabled:i,contentWidth:"menuFixed",triggerButton:m,children:[x,h]}),e[26]=i,e[27]=m,e[28]=x,e[29]=h,e[30]=j):j=e[30];let M;return e[31]!==j||e[32]!==u||e[33]!==p?(M=n.jsx(L,{label:u,description:p,control:j}),e[31]=j,e[32]=u,e[33]=p,e[34]=M):M=e[34],M}function k(){const t=_.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=n.jsx(c,{id:"settings.agent.configuration.defaultOption",defaultMessage:"Default",description:"Label for default config.toml option"}),t[0]=e):e=t[0],e}function le(t){const e=_.c(4),{policy:s}=t;switch(s){case"untrusted":{let o;return e[0]===Symbol.for("react.memo_cache_sentinel")?(o=n.jsx(c,{id:"settings.agent.configuration.approvalPolicy.untrusted",defaultMessage:"Untrusted",description:"Approval policy option: untrusted"}),e[0]=o):o=e[0],o}case"on-failure":{let o;return e[1]===Symbol.for("react.memo_cache_sentinel")?(o=n.jsx(c,{id:"settings.agent.configuration.approvalPolicy.onFailure",defaultMessage:"On failure",description:"Approval policy option: on failure"}),e[1]=o):o=e[1],o}case"on-request":{let o;return e[2]===Symbol.for("react.memo_cache_sentinel")?(o=n.jsx(c,{id:"settings.agent.configuration.approvalPolicy.onRequest",defaultMessage:"On request",description:"Approval policy option: on request"}),e[2]=o):o=e[2],o}case"never":{let o;return e[3]===Symbol.for("react.memo_cache_sentinel")?(o=n.jsx(c,{id:"settings.agent.configuration.approvalPolicy.never",defaultMessage:"Never",description:"Approval policy option: never"}),e[3]=o):o=e[3],o}}}function ae(t){const e=_.c(3),{mode:s}=t;switch(s){case"read-only":{let o;return e[0]===Symbol.for("react.memo_cache_sentinel")?(o=n.jsx(c,{id:"settings.agent.configuration.sandboxMode.readOnly",defaultMessage:"Read-only",description:"Sandbox mode option: read-only"}),e[0]=o):o=e[0],o}case"workspace-write":{let o;return e[1]===Symbol.for("react.memo_cache_sentinel")?(o=n.jsx(c,{id:"settings.agent.configuration.sandboxMode.workspaceWrite",defaultMessage:"Workspace write",description:"Sandbox mode option: workspace write"}),e[1]=o):o=e[1],o}case"danger-full-access":{let o;return e[2]===Symbol.for("react.memo_cache_sentinel")?(o=n.jsx(c,{id:"settings.agent.configuration.sandboxMode.fullAccess",defaultMessage:"Full access",description:"Sandbox mode option: full access"}),e[2]=o):o=e[2],o}}}function fe(){const t=_.c(6);let e,s;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=n.jsx(te,{slug:"agent"}),s=n.jsx(c,{id:"settings.agent.configuration.subtitle",defaultMessage:"These settings apply to anywhere Codex is used",description:"Subtitle for config.toml settings section"}),t[0]=e,t[1]=s):(e=t[0],s=t[1]);let o;t[2]===Symbol.for("react.memo_cache_sentinel")?(o=n.jsx(ie,{}),t[2]=o):o=t[2];let i,l;t[3]===Symbol.for("react.memo_cache_sentinel")?(i=n.jsx(c,{id:"settings.agent.configuration.configToml",defaultMessage:"config.toml",description:"Label for config.toml open button"}),l=n.jsx(c,{id:"settings.agent.configuration.configToml.description",defaultMessage:"Edit your config to customize agent behavior",description:"Description for config.toml open row"}),t[3]=i,t[4]=l):(i=t[3],l=t[4]);let a;return t[5]===Symbol.for("react.memo_cache_sentinel")?(a=n.jsx(z,{title:e,subtitle:s,children:n.jsx(P,{children:n.jsx(P.Content,{children:n.jsxs(Q,{children:[o,n.jsx(L,{label:i,description:n.jsxs(n.Fragment,{children:[l," ",n.jsxs("a",{className:"text-token-text-secondary hover:text-token-text-primary inline-flex items-center gap-1",href:H,target:"_blank",rel:"noreferrer",children:[n.jsx(c,{id:"settings.agent.configuration.configToml.docs",defaultMessage:"Docs",description:"Link label for config documentation"}),n.jsx(K,{className:"icon-xxs"})]})]}),control:n.jsx(ce,{})}),n.jsx(re,{})]})})})}),t[5]=a):a=t[5],a}function re(){const t=_.c(7),e=ee();let s,o;t[0]===Symbol.for("react.memo_cache_sentinel")?(s=n.jsx(c,{id:"settings.openSourceLicenses.rowLabel",defaultMessage:"Open source licenses",description:"Label for the open source licenses row"}),o=n.jsx(c,{id:"settings.openSourceLicenses.rowDescription",defaultMessage:"Third-party notices for bundled dependencies",description:"Description for the open source licenses row"}),t[0]=s,t[1]=o):(s=t[0],o=t[1]);let i;t[2]!==e?(i=()=>{e("/settings/open-source-licenses")},t[2]=e,t[3]=i):i=t[3];let l;t[4]===Symbol.for("react.memo_cache_sentinel")?(l=n.jsx(c,{id:"settings.openSourceLicenses.view",defaultMessage:"View",description:"Button label to open the open source licenses page"}),t[4]=l):l=t[4];let a;return t[5]!==i?(a=n.jsx(L,{label:s,description:o,control:n.jsx(C,{color:"secondary",size:"toolbar",onClick:i,children:l})}),t[5]=i,t[6]=a):a=t[6],a}function ce(){const t=_.c(13),{data:e}=G(),{data:s}=X(Y.RUN_CODEX_IN_WSL),{data:o}=R("codex-home"),i=J();let l;t[0]===Symbol.for("react.memo_cache_sentinel")?(l={cwd:null},t[0]=l):l=t[0];const a=i==="electron";let d;t[1]!==a?(d={params:l,queryConfig:{enabled:a,staleTime:oe.ONE_MINUTE}},t[1]=a,t[2]=d):d=t[2];const{data:g}=R("open-in-targets",d),b=Z("open-file"),y=e?.platform==="win32"&&e?.hasWsl&&s,u=o?.codexHome?`${o.codexHome}/config.toml`:null,p=g?.preferredTarget??void 0;let m;t[3]!==y?(m=y?n.jsx(c,{...D.openConfigTomlWsl}):n.jsx(c,{...D.openConfigToml}),t[3]=y,t[4]=m):m=t[4];const S=m;let f;t[5]!==u||t[6]!==b||t[7]!==p?(f=()=>{u&&b.mutate({path:u,cwd:null,target:p})},t[5]=u,t[6]=b,t[7]=p,t[8]=f):f=t[8];const r=!u;let x;return t[9]!==S||t[10]!==f||t[11]!==r?(x=n.jsx(C,{color:"secondary",size:"toolbar",className:"inline-flex w-fit",onClick:f,disabled:r,children:S}),t[9]=S,t[10]=f,t[11]=r,t[12]=x):x=t[12],x}export{fe as AgentSettings};
//# sourceMappingURL=agent-settings-C5vblFeJ.js.map
