import{c as $,m as z,n as W,j as a,l as G,S as K,o as O,p as Y,u as H,Q as J,i as X,q as U,h as V,k as I,M as y,s as Z,e as ee,d as te,g as ae,t as se,v as B,B as ie}from"./index-C4i7VkvA.js";function oe(){const i=$.c(10),e=z();let t;i[0]===Symbol.for("react.memo_cache_sentinel")?(t=["archived-threads"],i[0]=t):t=i[0];let u;i[1]!==e?(u={queryKey:t,queryFn:()=>e.listArchivedThreads(),staleTime:J.FIVE_SECONDS},i[1]=e,i[2]=u):u=i[2];const{data:v,isLoading:d,isError:n}=W(u);let c;i[3]!==v?(c=v===void 0?[]:v,i[3]=v,i[4]=c):c=i[4];const o=c;let l;i[5]===Symbol.for("react.memo_cache_sentinel")?(l=a.jsx(X,{slug:"data-controls"}),i[5]=l):l=i[5];let r;return i[6]!==o||i[7]!==n||i[8]!==d?(r=a.jsx(G,{title:l,children:a.jsx(K,{className:"gap-2",children:a.jsx(K.Content,{children:a.jsx(ne,{archivedThreads:o,isLoading:d,isError:n})})})}),i[6]=o,i[7]=n,i[8]=d,i[9]=r):r=i[9],r}function ne(i){const e=$.c(14),{archivedThreads:t,isLoading:u,isError:v}=i,d=O(),n=Y(),c=H();let o;e[0]!==d||e[1]!==n||e[2]!==c?(o=s=>{if(c==="electron"){d(`/local/${U(s)}`);return}n(s)},e[0]=d,e[1]=n,e[2]=c,e[3]=o):o=e[3];const l=o;if(u){let s;return e[4]===Symbol.for("react.memo_cache_sentinel")?(s=a.jsx("div",{className:"px-1.5 py-1",children:a.jsx(V,{children:a.jsx(I,{label:a.jsx(y,{id:"settings.dataControls.archivedChats.loading",defaultMessage:"Loading archived chats…",description:"Loading state label for archived chats list"}),control:null})})}),e[4]=s):s=e[4],s}if(v){let s;return e[5]===Symbol.for("react.memo_cache_sentinel")?(s=a.jsx("div",{className:"px-1.5 py-1",children:a.jsx(V,{children:a.jsx(I,{label:a.jsx(y,{id:"settings.dataControls.archivedChats.error",defaultMessage:"Could not load archived chats.",description:"Error state label for archived chats list"}),control:null})})}),e[5]=s):s=e[5],s}if(t.length===0){let s;return e[6]===Symbol.for("react.memo_cache_sentinel")?(s=a.jsx("div",{className:"px-1.5 py-1",children:a.jsx(V,{children:a.jsx(I,{label:a.jsx(y,{id:"settings.dataControls.archivedChats.empty",defaultMessage:"No archived chats.",description:"Empty state label for archived chats list"}),control:null})})}),e[6]=s):s=e[6],s}let r;if(e[7]!==t||e[8]!==l){let s;e[10]!==l?(s=m=>{const f=U(m.id);return a.jsx(re,{archivedThread:m,conversationId:f,onViewConversation:l},m.id)},e[10]=l,e[11]=s):s=e[11],r=t.map(s),e[7]=t,e[8]=l,e[9]=r}else r=e[9];let h;return e[12]!==r?(h=a.jsx("div",{className:"px-1.5 py-1",children:a.jsx(V,{className:"max-h-[min(80vh)] overflow-y-auto",children:r})}),e[12]=r,e[13]=h):h=e[13],h}function re(i){const e=$.c(62),{archivedThread:t,conversationId:u,onViewConversation:v}=i,d=z(),n=Z(),c=ee(),o=te();let l;e[0]!==t.id?(l=["unarchive-thread",t.id],e[0]=t.id,e[1]=l):l=e[1];let r;e[2]!==d||e[3]!==u?(r=async()=>d.unarchiveConversation(u),e[2]=d,e[3]=u,e[4]=r):r=e[4];let h;e[5]!==t.id||e[6]!==n?(h=async()=>{await n.cancelQueries({queryKey:["archived-threads"]});const x=n.getQueryData(["archived-threads"])??[];return n.setQueryData(["archived-threads"],x.filter(w=>w.id!==t.id)),{previousThreads:x}},e[5]=t.id,e[6]=n,e[7]=h):h=e[7];let s;e[8]!==o||e[9]!==n||e[10]!==c?(s=(x,w,E)=>{E?.previousThreads&&n.setQueryData(["archived-threads"],E.previousThreads),c.danger(o.formatMessage({id:"settings.dataControls.archivedChats.unarchiveError",defaultMessage:"Failed to unarchive chat",description:"Error message when unarchiving a chat"}))},e[8]=o,e[9]=n,e[10]=c,e[11]=s):s=e[11];let m;e[12]!==t.id||e[13]!==v||e[14]!==c?(m=()=>{const x=w=>a.jsx("button",{className:"text-token-link hover:underline underline-offset-2",type:"button",onClick:()=>{v(t.id)},children:w});c.info(a.jsx(y,{id:"settings.dataControls.archivedChats.unarchiveSuccess",defaultMessage:"Unarchived thread. <viewNowLink>View now</viewNowLink>",description:"Success toast after unarchiving a chat",values:{viewNowLink:x}}),{id:`unarchive-thread-${t.id}`})},e[12]=t.id,e[13]=v,e[14]=c,e[15]=m):m=e[15];let f;e[16]!==n?(f=()=>{n.invalidateQueries({queryKey:["archived-threads"]})},e[16]=n,e[17]=f):f=e[17];let A;e[18]!==l||e[19]!==r||e[20]!==h||e[21]!==s||e[22]!==m||e[23]!==f?(A={mutationKey:l,mutationFn:r,onMutate:h,onError:s,onSuccess:m,onSettled:f},e[18]=l,e[19]=r,e[20]=h,e[21]=s,e[22]=m,e[23]=f,e[24]=A):A=e[24];const g=ae(A);let D;e[25]!==t.preview?(D=se(t.preview).trim(),e[25]=t.preview,e[26]=D):D=e[26];const L=D;let j,p,C,Q;if(e[27]!==t.createdAt||e[28]!==t.cwd||e[29]!==t.path||e[30]!==t.updatedAt||e[31]!==o){const x=new Date(Number(t.updatedAt)*1e3),w=new Date(Number(t.createdAt)*1e3),E=Number.isFinite(x.getTime())?x:Number.isFinite(w.getTime())?w:null;let R;e[36]!==t.cwd||e[37]!==t.path?(R=B(t.cwd)??B(t.path),e[36]=t.cwd,e[37]=t.path,e[38]=R):R=e[38],C=R,p=E!=null,j=p?o.formatDate(E,{year:"numeric",month:"short",day:"numeric"}):"",Q=p?o.formatTime(E,{hour:"numeric",minute:"2-digit"}):"",e[27]=t.createdAt,e[28]=t.cwd,e[29]=t.path,e[30]=t.updatedAt,e[31]=o,e[32]=j,e[33]=p,e[34]=C,e[35]=Q}else j=e[32],p=e[33],C=e[34],Q=e[35];const F=Q;let b;e[39]!==L?(b=L.length>0?L:a.jsx(y,{id:"settings.dataControls.archivedChats.untitled",defaultMessage:"Untitled chat",description:"Fallback title for an archived chat"}),e[39]=L,e[40]=b):b=e[40];let S;e[41]!==b?(S=a.jsx("div",{className:"truncate text-base font-medium",children:b}),e[41]=b,e[42]=S):S=e[42];let N;e[43]!==j||e[44]!==p||e[45]!==C||e[46]!==F?(N=p?C?a.jsx(y,{id:"settings.dataControls.archivedChats.dateTimeWithRepo",defaultMessage:"{date}, {time} • {repo}",description:"Date, time, and repo name for an archived chat",values:{date:j,time:F,repo:C}}):a.jsx(y,{id:"settings.dataControls.archivedChats.dateTime",defaultMessage:"{date}, {time}",description:"Date and time for an archived chat",values:{date:j,time:F}}):null,e[43]=j,e[44]=p,e[45]=C,e[46]=F,e[47]=N):N=e[47];let T;e[48]!==N?(T=a.jsx("div",{className:"mt-1 flex min-w-0 flex-col gap-0.5 text-sm",children:a.jsx("div",{className:"text-token-text-secondary truncate",children:N})}),e[48]=N,e[49]=T):T=e[49];let M;e[50]!==S||e[51]!==T?(M=a.jsxs("div",{className:"text-token-text-primary min-w-0 flex-1 text-left",children:[S,T]}),e[50]=S,e[51]=T,e[52]=M):M=e[52];let _;e[53]!==g?(_=()=>{g.isPending||g.mutate()},e[53]=g,e[54]=_):_=e[54];let q;e[55]===Symbol.for("react.memo_cache_sentinel")?(q=a.jsx(y,{id:"settings.dataControls.archivedChats.unarchive",defaultMessage:"Unarchive",description:"Button label to unarchive a chat"}),e[55]=q):q=e[55];let k;e[56]!==_||e[57]!==g.isPending?(k=a.jsx(ie,{className:"shrink-0",color:"secondary",size:"toolbar",disabled:g.isPending,loading:g.isPending,onClick:_,children:q}),e[56]=_,e[57]=g.isPending,e[58]=k):k=e[58];let P;return e[59]!==M||e[60]!==k?(P=a.jsxs("div",{className:"hover:bg-token-list-hover-background flex w-full items-center justify-between gap-3 px-4 py-3",children:[M,k]}),e[59]=M,e[60]=k,e[61]=P):P=e[61],P}export{oe as DataControlsSettings};
//# sourceMappingURL=data-controls-BWsYBTPF.js.map
